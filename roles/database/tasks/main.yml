---
# tasks file for database
- name: install dependencies
  package: name={{item}} state=installed
  with_items:
       - mongodb

- name: prepare mongodb config file
  template:
   src: mongodb.conf.j2
   dest: /etc/mongodb.conf
   backup: yes
  notify:
  - restart mongodb

- name: ensure mongodb running
  service:
    name: mongodb
    state: started

- name: ensure port is open
  wait_for:
    host: 0.0.0.0
    port: 27017
    delay: 10
    state: present
